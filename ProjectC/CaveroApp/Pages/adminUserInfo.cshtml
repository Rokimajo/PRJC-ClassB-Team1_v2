@page
@model CaveroApp.Pages.adminUserInfo

@{
    Layout = "Shared/CaveroLayoutResponsive";
}

<!DOCTYPE html>

<html>
<head>
    <link rel="stylesheet" href="css/events.css"/>
    <link rel="stylesheet" href="css/layout.css"/>
    <link rel="stylesheet" href="css/eventheader.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <title></title>
    <style>
        .custom-event-card {
            max-width: 460px;
            position: relative;
        }
        .custom-button-container {
            position: absolute;
            top: 0;
            right: 0;
            display: flex;
        }
        .custom-button-small {
            max-width: 65px;
            margin-right: 5px;
        }
        .user-edit-list{
            display: flex;
            align-items: center;
            max-height: 720px;
            flex-direction: column;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 10px;
            border-radius: 15px;
            background: var(--collection-1-cavero-lichtpaars);
            box-shadow: 2px 2px 2px 2px #00030040 inset;
            text-align: center;
        }
    </style>
</head>
<body>
<div class="user-edit-list">
    @foreach (var user in @Model.Users())
    {
        <div class="event-card custom-event-card">
            <p>First Name: @(user.FirstName)</p>
            <p>Last Name: @(user.LastName)</p>
            <p>Email: @(user.Email)</p>
            <p>User ID: @(user.Id)</p>
            <div class="custom-button-container">
                <button class="button edit custom-button-small" data-user-id="@user.Id" data-firstName="@user.FirstName" data-lastName="@user.LastName" data-email="@user.Email">Edit</button>
                <form method="post" asp-page-handler="DeleteUser" onsubmit="return confirm('Are you sure you want to delete this user?');">
                    <input type="hidden" name="userToDelete.Id" value="@user.Id" />
                    <button class="button delete custom-button-small" type="submit">Delete</button>
                </form>
            </div>
        </div>
    }
</div>
    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <form method="post" asp-page-handler="UpdateUser">
                <label for="editId">ID:</label>
                <input type="text" id="editId" name="Id" readonly>

                <label for="editFirstName">First Name:</label>
                <input type="text" id="editFirstName" name="FirstName">

                <label for="editLastName">Last Name:</label>
                <input type="text" id="editLastName" name="LastName">

                <label for="editEmail">Email:</label>
                <input type="text" id="editEmail" name="Email">

                <input type="submit" value="Update">
            </form>
        </div>
    </div>

    <script>
        
        function openModal(userId, firstName, lastName, email) {
            document.getElementById("editId").value = userId;
            document.getElementById("editFirstName").value = firstName;
            document.getElementById("editLastName").value = lastName;
            document.getElementById("editEmail").value = email;
            document.getElementById("editModal").style.display = "block";
        }
        function closeModal() {
            document.getElementById("editModal").style.display = "none";
        }
        var editButtons = document.getElementsByClassName("button edit custom-button-small");
        for (var i = 0; i < editButtons.length; i++) {
            editButtons[i].addEventListener("click", function () {
                var userId = this.getAttribute("data-user-id");
                var firstName = this.getAttribute("data-firstName");
                var lastName = this.getAttribute("data-lastName");
                var email = this.getAttribute("data-email");

                openModal(userId, firstName, lastName, email);
            });
        }
    </script>
</body>
</html>
